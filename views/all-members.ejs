<!-- Wappler include head-page="layouts/main" fontawesome_5="cdn" bootstrap5="local" is="dmx-app" id="allmembers" appConnect="local" components="{dmxStateManagement:{},dmxDataTraversal:{},dmxBootstrap5TableGenerator:{},dmxBootstrap5Modal:{}}" -->
<meta name="ac:route" content="/all-members">
<dmx-query-manager id="qm"></dmx-query-manager>
<dmx-serverconnect id="scAllMembers" url="/api/Members/AllMembers" dmx-param:offset="content.qm.data.offset" dmx-param:limit="10000" dmx-param:dir="content.qm.data.dir" dmx-param:sort="content.qm.data.sort" dmx-on:success="varTitle.setValue('All Members')"></dmx-serverconnect>
<dmx-data-view id="dvAllMembers" dmx-bind:data="scAllMembers.data.AllMembers.data" filter="(created_at.lowercase().contains(Search.searchinput.value.lowercase())||business_line.lowercase().contains(Search.searchinput.value.lowercase())||first_name.lowercase().contains(Search.searchinput.value.lowercase())||last_name.lowercase().contains(Search.searchinput.value.lowercase())||company_name.lowercase().contains(Search.searchinput.value.lowercase())||email.lowercase().contains(Search.searchinput.value.lowercase())||telephone.lowercase().contains(Search.searchinput.value.lowercase())||address1.lowercase().contains(Search.searchinput.value.lowercase()))"></dmx-data-view>
<dmx-data-detail id="ddMemberDetails" dmx-bind:data="content.dvAllMembers.data" key="id"></dmx-data-detail>

<div class="col">
    <div class="table-responsive">
        <table class="table table-striped table-bordered table-hover table-sm">
            <thead>
                <tr>
                    <th class="sorting" dmx-on:click="qm.set('sort','$index+1');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='$index+1' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='$index+1' && qm.data.dir == 'desc'">Sl. No.</th>
                    <td class="sorting">Details</td>
                    <th class="sorting" dmx-on:click="qm.set('sort','created_at');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='created_at' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='created_at' && qm.data.dir == 'desc'">Created at</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','business_line');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='business_line' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='business_line' && qm.data.dir == 'desc'">Business line</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','member_id');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='member_id' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='member_id' && qm.data.dir == 'desc'">Member</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','first_name');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='first_name' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='first_name' && qm.data.dir == 'desc'">First name</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','last_name');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='last_name' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='last_name' && qm.data.dir == 'desc'">Last name</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','company_name');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='company_name' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='company_name' && qm.data.dir == 'desc'">Company name</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','email');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='email' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='email' && qm.data.dir == 'desc'">Email</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','telephone');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='telephone' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='telephone' && qm.data.dir == 'desc'">Telephone</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','address1');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='address1' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='address1' && qm.data.dir == 'desc'">Address1</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','address2');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='address2' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='address2' && qm.data.dir == 'desc'">Address2</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='' && qm.data.dir == 'desc'">Town/city</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','county');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='county' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='county' && qm.data.dir == 'desc'">County</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','psotcode');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='psotcode' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='psotcode' && qm.data.dir == 'desc'">Psotcode</th>
                    <th class="sorting" dmx-on:click="qm.set('sort','country');qm.set('dir',qm.data.dir == 'desc' ? 'asc' : 'desc')" dmx-class:sorting_asc="qm.data.sort=='country' && qm.data.dir == 'asc'" dmx-class:sorting_desc="qm.data.sort=='country' && qm.data.dir == 'desc'">Country</th>
                    <td class="sorting">Action</td>
                </tr>
            </thead>
            <tbody is="dmx-repeat" dmx-generator="bs5table" dmx-bind:repeat="dvAllMembers.data" id="tableRepeat2" dmx-state="qm" dmx-sort="sort" dmx-order="dir" key="id">
                <tr class="py-1">
                    <td dmx-text="$index+1"></td>
                    <td class="text-center">
                        <a class="text-black" dmx-bind:href="'/members-profile/'+member_id+'/'+first_name"><i class="mdi mdi-eye"></i></a>
                    </td>
                    <td dmx-text="created_at.formatDate('yyyy-MMM-dd hh:mm A')"></td>
                    <td dmx-text="business_line"></td>
                    <td dmx-text="member_id"></td>
                    <td dmx-text="first_name"></td>
                    <td dmx-text="last_name"></td>
                    <td dmx-text="company_name"></td>
                    <td dmx-text="email"></td>
                    <td dmx-text="telephone"></td>
                    <td dmx-text="address1"></td>
                    <td dmx-text="address2"></td>
                    <td dmx-text="town"></td>
                    <td dmx-text="county"></td>
                    <td dmx-text="psotcode"></td>
                    <td dmx-text="country"></td>
                    <td class="text-center">
                        <a href="#" class="text-black" data-bs-toggle="modal" data-bs-target="#MemberEditModal" dmx-on:click="ddMemberDetails.select(id);MemberEditModal.show()"><i class="fa fa-pencil-alt"></i></a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="modal fade" id="MemberEditModal" tabindex="-1" role="dialog" aria-labelledby="MemberEditModal" aria-hidden="true" is="dmx-bs5-modal">
    <div class="modal-dialog modal-lg" role="document">
        <form is="dmx-serverconnect-form" id="scformMembers" method="post" action="/api/Members/EditMember" dmx-generator="bootstrap5" dmx-form-type="horizontal" dmx-on:success="scAllMembers.load({limit: 10000},true);notifies1.success('Member Details Updated Successfully');" dmx-on:invalid="notifies1.warning(lastError.response)" dmx-on:forbidden="notifies1.warning(lastError.response)" dmx-on:unauthorized="notifies1.warning(lastError.response)" dmx-on:error="notifies1.warning(lastError.response)">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="DelModalTitle">Edit Member Info.</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" dmx-on:close="scformMembers.reset(true);">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <input type="hidden" class="form-control" id="MemberId" name="MemberId" required dmx-bind:value="ddMemberDetails.data.member_id">
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_business_line" class=" col-form-label">Business line</label>
                            <div class="col-sm-12 px-0">
                                <select type="text" class="form-control form-select" id="inp_business_line" name="business_line" aria-describedby="inp_business_line_help" placeholder="Enter Business line" dmx-bind:value="ddMemberDetails.data.business_line">
                                    <option value="">Select</option>
                                    <option value="mfs">MFS</option>
                                    <option value="js">JS</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_first_name" class=" col-form-label">First name</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_first_name" name="first_name" aria-describedby="inp_first_name_help" placeholder="Enter First name" dmx-bind:value="ddMemberDetails.data.first_name">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_last_name" class=" col-form-label">Last name</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_last_name" name="last_name" aria-describedby="inp_last_name_help" placeholder="Enter Last name" dmx-bind:value="ddMemberDetails.data.last_name">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_company_name" class=" col-form-label">Company name</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_company_name" name="company_name" aria-describedby="inp_company_name_help" placeholder="Enter Company name" dmx-bind:value="ddMemberDetails.data.company_name">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_email" class=" col-form-label">Email</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_email" name="email" aria-describedby="inp_email_help" placeholder="Enter Email" dmx-bind:value="ddMemberDetails.data.email">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_telephone" class=" col-form-label">Telephone</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_telephone" name="telephone" aria-describedby="inp_telephone_help" placeholder="Enter Telephone" dmx-bind:value="ddMemberDetails.data.telephone">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_address1" class=" col-form-label">Address1</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_address1" name="address1" aria-describedby="inp_address1_help" placeholder="Enter Address1" dmx-bind:value="ddMemberDetails.data.address1">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_address2" class=" col-form-label">Address2</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_address2" name="address2" aria-describedby="inp_address2_help" placeholder="Enter Address2" dmx-bind:value="ddMemberDetails.data.address2">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_town" class=" col-form-label">Town/ City</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_town" name="town" aria-describedby="inp_town_help" placeholder="Enter Town" dmx-bind:value="ddMemberDetails.data.town">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_county" class=" col-form-label">County</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_county" name="county" aria-describedby="inp_county_help" placeholder="Enter County" dmx-bind:value="ddMemberDetails.data.county">
                            </div>
                        </div>
                        <div class="mb-3 col-12 col-md-6">
                            <label for="inp_psotcode" class=" col-form-label">Psotcode</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_psotcode" name="psotcode" aria-describedby="inp_psotcode_help" placeholder="Enter Psotcode" dmx-bind:value="ddMemberDetails.data.psotcode">
                            </div>
                        </div>
                        <!-- <div class="mb-3 col-12 col-md-6">
                            <label for="inp_country" class=" col-form-label">Country</label>
                            <div class="col-sm-12 px-0">
                                <input type="text" class="form-control" id="inp_country" name="country" aria-describedby="inp_country_help" placeholder="Enter Country" dmx-bind:value="ddMemberDetails.data.company_name">
                            </div>
                        </div> -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-pill" data-dismiss="modal" dmx-on:click="scformMembers.reset(true);MemberEditModal.hide()">Close</button>
                    <button type="submit" class="btn btn-success btn-pill">Update</button>
                </div>
            </div>
        </form>
    </div>
</div>